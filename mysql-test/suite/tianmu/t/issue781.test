--source include/have_tianmu.inc

--disable_warnings
DROP DATABASE IF EXISTS issue781_test;
--enable_warnings

CREATE DATABASE issue781_test;

USE issue781_test;

--disable_warnings

# safe mode

# test with no primary key

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 int, d2 int) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 int, d2 int) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## select before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999);

## select again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998);

## select again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (99998);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998;

## select again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 != 99998;

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with NOT IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with NOT IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999);

## select again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125);

## select again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## select again

SELECT * FROM cs1;

## delete with NOT eq

DELETE FROM cs1 WHERE d1 != 33;

## select again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# test with primary key

## default safe mode

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## SELECT before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=658, d2=785 WHERE d1 NOT IN (99998) LIMIT 1;	

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=4587, d2=2456 WHERE d1 != 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## SELECT again

SELECT * FROM cs1;

## delete with NOT eq

DELETE FROM cs1 WHERE d1 != 33;

## SELECT again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# not safe mode

set sql_safe_updates=0;

# test with no primary key

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 int, d2 int) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 int, d2 int) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## select before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999);

## select again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998);

## select again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (99998);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998;

## select again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 != 99998;

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with NOT IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with NOT IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999);

## select again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125);

## select again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## select again

SELECT * FROM cs1;

## delete with NOT eq

DELETE FROM cs1 WHERE d1 != 33;

## select again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# test with primary key

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## SELECT before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=658, d2=785 WHERE d1 NOT IN (99998) LIMIT 1;	

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=4587, d2=2456 WHERE d1 != 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## SELECT again

SELECT * FROM cs1;

## delete with NOT eq

DELETE FROM cs1 WHERE d1 != 33;

## SELECT again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# test with primary key

## safe mode

set sql_safe_updates=1;

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## SELECT before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=658, d2=785 WHERE d1 NOT IN (99998) LIMIT 1;	

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=4587, d2=2456 WHERE d1 != 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## SELECT again

SELECT * FROM cs1;

## delete with NOT eq

--error 1175
DELETE FROM cs1 WHERE d1 != 33;

## SELECT again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# not safe mode

set sql_safe_updates=0;

# test with no primary key

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 int, d2 int) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 int, d2 int) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## select before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999) LIMIT 1;

## select again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999) LIMIT 1;

## select again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998);

## select again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=87464, d2=46584 WHERE d1 NOT IN (99998) LIMIT 1;

## select again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998 LIMIT 1;

## select again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=4646, d2=878 WHERE d1 != 99998 LIMIT 1;

## select again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=464, d2=484 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with NOT IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with NOT IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999);

## select again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999);

## select again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125);

## select again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125);

## select again

SELECT * FROM cs1;

## reinsert

DROP TABLE IF EXISTS cs1;
CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## select again

SELECT * FROM cs1;

## delete with NOT eq

DELETE FROM cs1 WHERE d1 != 33;

## select again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# not safe mode

set sql_safe_updates=0;

# test with no primary key

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 int, d2 int) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 int, d2 int) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## select before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999);

## select again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998);

## select again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (99998);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998;

## select again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 != 99998;

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with NOT IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with NOT IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999);

## select again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125);

## select again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125);

## select again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## select again

SELECT * FROM cs1;

## delete with NOT eq

DELETE FROM cs1 WHERE d1 != 33;

## select again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# test with primary key

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## SELECT before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=658, d2=785 WHERE d1 NOT IN (99998) LIMIT 1;	

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=4587, d2=2456 WHERE d1 != 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DROP TABLE IF EXISTS cs2;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## SELECT again

SELECT * FROM cs1;

## delete with NOT eq

DELETE FROM cs1 WHERE d1 != 33;

## SELECT again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# test with primary key

## not safe mode

set sql_safe_updates=0;

## DDL

DROP TABLE IF EXISTS cs1;
DROP TABLE IF EXISTS cs2;

CREATE TABLE cs1 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;
CREATE TABLE cs2 (d1 INT PRIMARY KEY, d2 INT) ENGINE=TIANMU;

## insert data

INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## SELECT before update

SELECT * FROM cs1;

## update with IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of more than one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 NOT IN (125, 99999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with IN of one elem

UPDATE cs1 SET d1=888, d2=777 WHERE d1 IN (99998) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with NOT IN of one elem

UPDATE cs1 SET d1=658, d2=785 WHERE d1 NOT IN (99998) LIMIT 1;	

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## update with eq

UPDATE cs1 SET d1=999, d2=777 WHERE d1 = 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## update with not eq

UPDATE cs1 SET d1=4587, d2=2456 WHERE d1 != 99998 LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330, 770) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33, 77) ) LIMIT 1;   

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## NOT EXISTS clause with IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE NOT EXISTS (SELECT 1 from cs2 WHERE d1 IN (330) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

DELETE FROM cs2;
INSERT INTO cs2 VALUES (125, 125);
INSERT INTO cs2 VALUES (-125, -125);
INSERT INTO cs2 VALUES (77, 55);
INSERT INTO cs2 VALUES (33, 66);
INSERT INTO cs2 VALUES (99998, 998);
INSERT INTO cs2 VALUES (99999, 999);

## EXISTS clause with not IN more than one elem

UPDATE cs1 SET d1=999, d2=777 WHERE EXISTS (SELECT 1 from cs2 WHERE d1 NOT IN (33) ) LIMIT 1;  

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN of more than one elem

DELETE FROM cs1 WHERE d1 IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

DELETE FROM cs1 WHERE d1 NOT IN (77, 999) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with IN one elem

DELETE FROM cs1 WHERE d1 IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## delete with NOT IN one elem

DELETE FROM cs1 WHERE d1 NOT IN (-125) LIMIT 1;

## SELECT again

SELECT * FROM cs1;

## reinsert

DELETE FROM cs1;
INSERT INTO cs1 VALUES (125, 125);
INSERT INTO cs1 VALUES (-125, -125);
INSERT INTO cs1 VALUES (77, 55);
INSERT INTO cs1 VALUES (33, 66);
INSERT INTO cs1 VALUES (99998, 998);
INSERT INTO cs1 VALUES (99999, 999);

## delete with eq

DELETE FROM cs1 WHERE d1 = 33;

## SELECT again

SELECT * FROM cs1;

## delete with NOT eq

DELETE FROM cs1 WHERE d1 != 33;

## SELECT again

SELECT * FROM cs1;

## clean test table

DROP TABLE cs1;
DROP TABLE cs2;

# test with json type

--error 6
CREATE TABLE cs1 (c1 JSON, c2 INT) ENGINE=TIANMU;

DROP DATABASE issue781_test;
