#
# Test unsigned_math
#
DROP DATABASE IF EXISTS unsigned_math_test;
CREATE DATABASE unsigned_math_test;
USE unsigned_math_test;
create table j1 (j1_key int);
insert into j1 values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(14),(15),(null);
ALTER TABLE j1 ADD COLUMN CUTINYINT TINYINT UNSIGNED;
ALTER TABLE j1 ADD COLUMN CUSMALLINT SMALLINT UNSIGNED;
ALTER TABLE j1 ADD COLUMN CUINTEGER INT UNSIGNED;
ALTER TABLE j1 ADD COLUMN CUBIGINT BIGINT UNSIGNED;
UPDATE j1 SET CUTINYINT=127;
UPDATE j1 SET CUSMALLINT=32767;
UPDATE j1 SET CUINTEGER=2147483647;
UPDATE j1 SET CUBIGINT=9223372036854775807;
SELECT 'ABS1', ABS(CUTINYINT) FROM j1 WHERE j1_key=1;
ABS1	ABS(CUTINYINT)
ABS1	127
SELECT 'ABS2', ABS(CUSMALLINT) FROM j1 WHERE j1_key=1;
ABS2	ABS(CUSMALLINT)
ABS2	32767
SELECT 'ABS3', ABS(CUINTEGER) FROM j1 WHERE j1_key=1;
ABS3	ABS(CUINTEGER)
ABS3	2147483647
SELECT 'ABS4', ABS(CUBIGINT) FROM j1 WHERE j1_key=1;
ABS4	ABS(CUBIGINT)
ABS4	9223372036854775807
SELECT 'CEIL1', CEIL(CUTINYINT) FROM j1 WHERE j1_key=1;
CEIL1	CEIL(CUTINYINT)
CEIL1	127
SELECT 'CEIL2', CEIL(CUSMALLINT) FROM j1 WHERE j1_key=1;
CEIL2	CEIL(CUSMALLINT)
CEIL2	32767
SELECT 'CEIL3', CEIL(CUINTEGER) FROM j1 WHERE j1_key=1;
CEIL3	CEIL(CUINTEGER)
CEIL3	2147483647
SELECT 'CEIL4', CEIL(CUBIGINT) FROM j1 WHERE j1_key=1;
CEIL4	CEIL(CUBIGINT)
CEIL4	9223372036854775807
SELECT 'FLOOR1', FLOOR(CUTINYINT) FROM j1 WHERE j1_key=1;
FLOOR1	FLOOR(CUTINYINT)
FLOOR1	127
SELECT 'FLOOR2', FLOOR(CUSMALLINT) FROM j1 WHERE j1_key=1;
FLOOR2	FLOOR(CUSMALLINT)
FLOOR2	32767
SELECT 'FLOOR3', FLOOR(CUINTEGER) FROM j1 WHERE j1_key=1;
FLOOR3	FLOOR(CUINTEGER)
FLOOR3	2147483647
SELECT 'FLOOR4', FLOOR(CUBIGINT) FROM j1 WHERE j1_key=1;
FLOOR4	FLOOR(CUBIGINT)
FLOOR4	9223372036854775807
SELECT 'DIV1', CUINTEGER DIV CUTINYINT FROM j1 WHERE j1_key=1;
DIV1	CUINTEGER DIV CUTINYINT
DIV1	16909320
SELECT 'DIV2', CUINTEGER DIV CUSMALLINT FROM j1 WHERE j1_key=1;
DIV2	CUINTEGER DIV CUSMALLINT
DIV2	65538
SELECT 'DIV3', CUBIGINT DIV CUTINYINT FROM j1 WHERE j1_key=1;
DIV3	CUBIGINT DIV CUTINYINT
DIV3	72624976668147841
SELECT 'DIV4', CUBIGINT DIV CUSMALLINT FROM j1 WHERE j1_key=1;
DIV4	CUBIGINT DIV CUSMALLINT
DIV4	281483566907400
SELECT 'DIV5', CUBIGINT DIV CUINTEGER FROM j1 WHERE j1_key=1;
DIV5	CUBIGINT DIV CUINTEGER
DIV5	4294967298
SELECT 'DIV6', CUINTEGER DIV CUBIGINT FROM j1 WHERE j1_key=1;
DIV6	CUINTEGER DIV CUBIGINT
DIV6	0
SELECT 'EXP1', EXP(CUTINYINT) FROM j1 WHERE j1_key=1;
EXP1	EXP(CUTINYINT)
EXP1	1.4302079958348105e55
SELECT 'LN1', LN(CUTINYINT) FROM j1 WHERE j1_key=1;
LN1	LN(CUTINYINT)
LN1	4.844187086458591
SELECT 'LN2', LN(CUSMALLINT) FROM j1 WHERE j1_key=1;
LN2	LN(CUSMALLINT)
LN2	10.397177190355384
SELECT 'LN3', LN(CUINTEGER) FROM j1 WHERE j1_key=1;
LN3	LN(CUINTEGER)
LN3	21.487562596892644
SELECT 'LN4', LN(CUBIGINT) FROM j1 WHERE j1_key=1;
LN4	LN(CUBIGINT)
LN4	43.66827237527655
SELECT 'LOG1', LOG(CUTINYINT) FROM j1 WHERE j1_key=1;
LOG1	LOG(CUTINYINT)
LOG1	4.844187086458591
SELECT 'LOG2', LOG(CUSMALLINT) FROM j1 WHERE j1_key=1;
LOG2	LOG(CUSMALLINT)
LOG2	10.397177190355384
SELECT 'LOG3', LOG(CUINTEGER) FROM j1 WHERE j1_key=1;
LOG3	LOG(CUINTEGER)
LOG3	21.487562596892644
SELECT 'LOG4', LOG(CUBIGINT) FROM j1 WHERE j1_key=1;
LOG4	LOG(CUBIGINT)
LOG4	43.66827237527655
SELECT 'LOG21', LOG2(CUTINYINT) FROM j1 WHERE j1_key=1;
LOG21	LOG2(CUTINYINT)
LOG21	6.988684686772166
SELECT 'LOG22', LOG2(CUSMALLINT) FROM j1 WHERE j1_key=1;
LOG22	LOG2(CUSMALLINT)
LOG22	14.999955971769559
SELECT 'LOG23', LOG2(CUINTEGER) FROM j1 WHERE j1_key=1;
LOG23	LOG2(CUINTEGER)
LOG23	30.999999999328196
SELECT 'LOG24', LOG2(CUBIGINT) FROM j1 WHERE j1_key=1;
LOG24	LOG2(CUBIGINT)
LOG24	63
SELECT 'LOG101', LOG10(CUTINYINT) FROM j1 WHERE j1_key=1;
LOG101	LOG10(CUTINYINT)
LOG101	2.103803720955957
SELECT 'LOG102', LOG10(CUSMALLINT) FROM j1 WHERE j1_key=1;
LOG102	LOG10(CUSMALLINT)
LOG102	4.515436681141699
SELECT 'LOG103', LOG10(CUINTEGER) FROM j1 WHERE j1_key=1;
LOG103	LOG10(CUINTEGER)
LOG103	9.331929865381182
SELECT 'LOG104', LOG10(CUBIGINT) FROM j1 WHERE j1_key=1;
LOG104	LOG10(CUBIGINT)
LOG104	18.964889726830815
SELECT 'MD51', MD5(CUTINYINT) FROM j1 WHERE j1_key=1;
MD51	MD5(CUTINYINT)
MD51	ec5decca5ed3d6b8079e2e7e7bacc9f2
SELECT 'MD52', MD5(CUSMALLINT) FROM j1 WHERE j1_key=1;
MD52	MD5(CUSMALLINT)
MD52	7cf91b300ff3ecef82c59dd47b89253a
SELECT 'MD53', MD5(CUINTEGER) FROM j1 WHERE j1_key=1;
MD53	MD5(CUINTEGER)
MD53	c588c0a459f4ccc6f3dd26518d24707a
SELECT 'MD54', MD5(CUBIGINT) FROM j1 WHERE j1_key=1;
MD54	MD5(CUBIGINT)
MD54	15767b252275cf5107bba9267b88e787
SELECT 'MOD1', MOD(CUTINYINT,10) FROM j1 WHERE j1_key=1;
MOD1	MOD(CUTINYINT,10)
MOD1	7
SELECT 'MOD2', MOD(CUSMALLINT,9) FROM j1 WHERE j1_key=1;
MOD2	MOD(CUSMALLINT,9)
MOD2	7
SELECT 'MOD3', MOD(CUINTEGER,8) FROM j1 WHERE j1_key=1;
MOD3	MOD(CUINTEGER,8)
MOD3	7
SELECT 'MOD4', MOD(CUBIGINT,16) FROM j1 WHERE j1_key=1;
MOD4	MOD(CUBIGINT,16)
MOD4	15
SELECT 'NULLIF1', NULLIF(CUTINYINT,127) FROM j1 WHERE j1_key=1;
NULLIF1	NULLIF(CUTINYINT,127)
NULLIF1	NULL
SELECT 'NULLIF2', NULLIF(CUSMALLINT,32767) FROM j1 WHERE j1_key=1;
NULLIF2	NULLIF(CUSMALLINT,32767)
NULLIF2	NULL
SELECT 'NULLIF3', NULLIF(CUINTEGER,2147483647) FROM j1 WHERE j1_key=1;
NULLIF3	NULLIF(CUINTEGER,2147483647)
NULLIF3	NULL
SELECT 'NULLIF4', NULLIF(CUBIGINT,9223372036854775807) FROM j1 WHERE j1_key=1;
NULLIF4	NULLIF(CUBIGINT,9223372036854775807)
NULLIF4	NULL
SELECT 'NULLIF5', NULLIF(CUTINYINT,127) FROM j1 WHERE j1_key=1;
NULLIF5	NULLIF(CUTINYINT,127)
NULLIF5	NULL
SELECT 'NULLIF6', NULLIF(CUSMALLINT,32767) FROM j1 WHERE j1_key=1;
NULLIF6	NULLIF(CUSMALLINT,32767)
NULLIF6	NULL
SELECT 'NULLIF7', NULLIF(CUINTEGER,2147483647) FROM j1 WHERE j1_key=1;
NULLIF7	NULLIF(CUINTEGER,2147483647)
NULLIF7	NULL
SELECT 'NULLIF8', NULLIF(CUBIGINT,9223372036854775807) FROM j1 WHERE j1_key=1;
NULLIF8	NULLIF(CUBIGINT,9223372036854775807)
NULLIF8	NULL
SELECT 'POW1', POW(CUTINYINT,4) FROM j1 WHERE j1_key=1;
POW1	POW(CUTINYINT,4)
POW1	260144641
SELECT 'POW2', POW(CUSMALLINT,4) FROM j1 WHERE j1_key=1;
POW2	POW(CUSMALLINT,4)
POW2	1.1527807735608115e18
SELECT 'POW3', POW(CUINTEGER,4) FROM j1 WHERE j1_key=1;
POW3	POW(CUINTEGER,4)
POW3	2.1267647892944573e37
SELECT 'POW4', POW(CUBIGINT,4) FROM j1 WHERE j1_key=1;
POW4	POW(CUBIGINT,4)
POW4	7.237005577332262e75
SELECT 'ROUND1', ROUND(CUTINYINT) FROM j1 WHERE j1_key=1;
ROUND1	ROUND(CUTINYINT)
ROUND1	127
SELECT 'ROUND2', ROUND(CUSMALLINT) FROM j1 WHERE j1_key=1;
ROUND2	ROUND(CUSMALLINT)
ROUND2	32767
SELECT 'ROUND3', ROUND(CUINTEGER) FROM j1 WHERE j1_key=1;
ROUND3	ROUND(CUINTEGER)
ROUND3	2147483647
SELECT 'ROUND4', ROUND(CUBIGINT) FROM j1 WHERE j1_key=1;
ROUND4	ROUND(CUBIGINT)
ROUND4	9223372036854775807
SELECT 'SIGN1', SIGN(CUTINYINT) FROM j1 WHERE j1_key=1;
SIGN1	SIGN(CUTINYINT)
SIGN1	1
SELECT 'SIGN2', SIGN(CUSMALLINT) FROM j1 WHERE j1_key=1;
SIGN2	SIGN(CUSMALLINT)
SIGN2	1
SELECT 'SIGN3', SIGN(CUINTEGER) FROM j1 WHERE j1_key=1;
SIGN3	SIGN(CUINTEGER)
SIGN3	1
SELECT 'SIGN4', SIGN(CUBIGINT) FROM j1 WHERE j1_key=1;
SIGN4	SIGN(CUBIGINT)
SIGN4	1
SELECT 'SIN1', SIN(CUTINYINT) FROM j1 WHERE j1_key=1;
SIN1	SIN(CUTINYINT)
SIN1	0.972630067242408
SELECT 'SIN2', SIN(CUSMALLINT) FROM j1 WHERE j1_key=1;
SIN2	SIN(CUSMALLINT)
SIN2	0.18750655394138943
SELECT 'SIN3', SIN(CUINTEGER) FROM j1 WHERE j1_key=1;
SIN3	SIN(CUINTEGER)
SIN3	-0.7249165551445564
SELECT 'SIN4', SIN(CUBIGINT) FROM j1 WHERE j1_key=1;
SIN4	SIN(CUBIGINT)
SIN4	0.9999303766734422
SELECT 'SQRT1', SQRT(CUTINYINT) FROM j1 WHERE j1_key=1;
SQRT1	SQRT(CUTINYINT)
SQRT1	11.269427669584644
SELECT 'SQRT2', SQRT(CUSMALLINT) FROM j1 WHERE j1_key=1;
SQRT2	SQRT(CUSMALLINT)
SQRT2	181.01657382681842
SELECT 'SQRT3', SQRT(CUINTEGER) FROM j1 WHERE j1_key=1;
SQRT3	SQRT(CUINTEGER)
SQRT3	46340.950001051984
SELECT 'SQRT4', SQRT(CUBIGINT) FROM j1 WHERE j1_key=1;
SQRT4	SQRT(CUBIGINT)
SQRT4	3037000499.97605
SELECT 'TAN1', TAN(CUTINYINT) FROM j1 WHERE j1_key=1;
TAN1	TAN(CUTINYINT)
TAN1	4.185891831851989
SELECT 'TAN2', TAN(CUSMALLINT) FROM j1 WHERE j1_key=1;
TAN2	TAN(CUSMALLINT)
TAN2	0.19089234430221486
SELECT 'TAN3', TAN(CUINTEGER) FROM j1 WHERE j1_key=1;
TAN3	TAN(CUINTEGER)
TAN3	1.0523779637351338
SELECT 'TAN4', TAN(CUBIGINT) FROM j1 WHERE j1_key=1;
TAN4	TAN(CUBIGINT)
TAN4	84.73931296875567
ALTER TABLE j1 DROP COLUMN CUTINYINT;
ALTER TABLE j1 DROP COLUMN CUSMALLINT;
ALTER TABLE j1 DROP COLUMN CUINTEGER;
ALTER TABLE j1 DROP COLUMN CUBIGINT;
drop table j1;
DROP DATABASE unsigned_math_test;
