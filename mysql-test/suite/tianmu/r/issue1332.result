DROP DATABASE IF EXISTS issue1332;
CREATE DATABASE issue1332;
USE issue1332;
drop table if exists tb;
create table tb(a bigint, b int, c DATETIME) engine=tianmu;
insert into tb values(-9223372036854775806, 2147483647, '1111-11-11 11:11:11'),
(-922337203685477580, -2147483647, '1111-11-11 11:11:11'),
(-55, -55, '1111-11-11 11:11:11'),
(-22, 22, '1111-11-11 11:11:11'),
(-10, 33, '1111-11-11 11:11:11'),
(-4, 44, '1111-11-11 11:11:11'),
(0, 0, '1111-11-11 11:11:11'),
(2, 2, '1111-11-11 11:11:11'),
(6, 6, '1111-11-11 11:11:11'),
(9223372036854775807, 8, '1111-11-11 11:11:11');
select * from tb;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a < -10;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
select * from tb where a > 4567890123456789;
a	b	c
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a > 0;
a	b	c
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a between -9223372036854775806 and 0;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
select * from tb where a between -9223372036854775807 and 0;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
select * from tb where a between -9223372036854775808 and 9223372036854775807;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a between -22 and 7;
a	b	c
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
select * from tb where a not in (3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a not in (-3,3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a not in (-3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a in (-3);
a	b	c
select * from tb where a in (-3, 3);
a	b	c
select * from tb where a in (select sum(b) from tb where b < 6);
a	b	c
select * from tb where a is null;
a	b	c
select * from tb where a is not null;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a in (not null);
a	b	c
select * from tb where a not in (null);
a	b	c
select * from tb where b < -10;
a	b	c
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
select * from tb where b < 2147483647;
a	b	c
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where b > -2147483647;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where b > 0;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where b between -2147483647 and 0;
a	b	c
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
select * from tb where b between -22 and 7;
a	b	c
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
select * from tb where b not in (3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where b not in (-3,3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where b not in (-3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where b in (-3);
a	b	c
select * from tb where b in (-3, 3);
a	b	c
select * from tb where b is null;
a	b	c
select * from tb where b is not null;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where b in (not null);
a	b	c
select * from tb where b not in (null);
a	b	c
SELECT * FROM tb WHERE c BETWEEN '111-11-10' AND '1111-11-12';
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
insert into tb values(null, null, null), (null, null, null);
select * from tb;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
NULL	NULL	NULL
NULL	NULL	NULL
select * from tb where a < -10;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
select * from tb where a > 4567890123456789;
a	b	c
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a > 0;
a	b	c
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a between -9223372036854775806 and 0;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
select * from tb where a between -22 and 7;
a	b	c
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
select * from tb where a not in (3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a not in (-3,3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a not in (-3);
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a in (-3);
a	b	c
select * from tb where a in (-3, 3);
a	b	c
select * from tb where a is null;
a	b	c
NULL	NULL	NULL
NULL	NULL	NULL
select * from tb where a is not null;
a	b	c
-9223372036854775806	2147483647	1111-11-11 11:11:11
-922337203685477580	-2147483647	1111-11-11 11:11:11
-55	-55	1111-11-11 11:11:11
-22	22	1111-11-11 11:11:11
-10	33	1111-11-11 11:11:11
-4	44	1111-11-11 11:11:11
0	0	1111-11-11 11:11:11
2	2	1111-11-11 11:11:11
6	6	1111-11-11 11:11:11
9223372036854775807	8	1111-11-11 11:11:11
select * from tb where a in (not null);
a	b	c
select * from tb where a not in (null);
a	b	c
drop table tb;
create table tb(a bigint) engine=tianmu;
insert into tb values(-55), (-22), (-10), (-4), (0), (2), (6);
select * from tb;
a
-55
-22
-10
-4
0
2
6
select * from tb where a < -55;
a
select * from tb where a < 0;
a
-55
-22
-10
-4
select * from tb where a > 6;
a
select * from tb where a > 0;
a
2
6
select * from tb where a between -9223372036854775806 and 0;
a
-55
-22
-10
-4
0
select * from tb where a between -22 and 7;
a
-22
-10
-4
0
2
6
select * from tb where a between 22 and 33;
a
select * from tb where a between -555 and -56;
a
select * from tb where a not in (3333);
a
-55
-22
-10
-4
0
2
6
select * from tb where a not in (-3,3333);
a
-55
-22
-10
-4
0
2
6
select * from tb where a not in (-33333);
a
-55
-22
-10
-4
0
2
6
select * from tb where a in (-3);
a
select * from tb where a in (-3, 3);
a
select * from tb where a is null;
a
select * from tb where a is not null;
a
-55
-22
-10
-4
0
2
6
select * from tb where a in (not null);
a
select * from tb where a not in (null);
a
insert into tb values(null), (null);
select * from tb;
a
-55
-22
-10
-4
0
2
6
NULL
NULL
select * from tb where a < -55;
a
select * from tb where a < 0;
a
-55
-22
-10
-4
select * from tb where a > 6;
a
select * from tb where a > 0;
a
2
6
select * from tb where a between -9223372036854775806 and 0;
a
-55
-22
-10
-4
0
select * from tb where a between -9223372036854775807 and 0;
a
-55
-22
-10
-4
0
select * from tb where a between -22 and 7;
a
-22
-10
-4
0
2
6
select * from tb where a between 22 and 33;
a
select * from tb where a between -555 and -56;
a
select * from tb where a not in (3333);
a
-55
-22
-10
-4
0
2
6
select * from tb where a not in (-3,3333);
a
-55
-22
-10
-4
0
2
6
select * from tb where a not in (-33333);
a
-55
-22
-10
-4
0
2
6
select * from tb where a in (-3);
a
select * from tb where a in (-3, 3);
a
select * from tb where a is null;
a
NULL
NULL
select * from tb where a is not null;
a
-55
-22
-10
-4
0
2
6
select * from tb where a in (not null);
a
select * from tb where a not in (null);
a
drop table tb;
create table tb(a bigint) engine=tianmu;
insert into tb values(0), (0), (0);
select * from tb;
a
0
0
0
select * from tb where a < -55;
a
select * from tb where a > 0;
a
select * from tb where a > -1;
a
0
0
0
select * from tb where a between -3 and -1;
a
select * from tb where a between 1 and 3;
a
select * from tb where a between 0 and 0;
a
0
0
0
select * from tb where a between -1 and 3;
a
0
0
0
select * from tb where a between -1 and 0;
a
0
0
0
select * from tb where a between 0 and 3;
a
0
0
0
select * from tb where a not in (3);
a
0
0
0
select * from tb where a not in (-3,3);
a
0
0
0
select * from tb where a not in (-125);
a
0
0
0
select * from tb where a in (-3);
a
select * from tb where a in (-3, 3);
a
select * from tb where a is null;
a
select * from tb where a is not null;
a
0
0
0
select * from tb where a in (not null);
a
select * from tb where a not in (null);
a
insert into tb values(null), (null);
select * from tb;
a
0
0
0
NULL
NULL
select * from tb where a < -55;
a
select * from tb where a > 0;
a
select * from tb where a > -1;
a
0
0
0
select * from tb where a between -3 and -1;
a
select * from tb where a between 1 and 3;
a
select * from tb where a between 0 and 0;
a
0
0
0
select * from tb where a between -1 and 3;
a
0
0
0
select * from tb where a between -1 and 0;
a
0
0
0
select * from tb where a between 0 and 3;
a
0
0
0
select * from tb where a not in (3);
a
0
0
0
select * from tb where a not in (-3,3);
a
0
0
0
select * from tb where a not in (-125);
a
0
0
0
select * from tb where a in (-3);
a
select * from tb where a in (-3, 3);
a
select * from tb where a is null;
a
NULL
NULL
select * from tb where a is not null;
a
0
0
0
select * from tb where a in (not null);
a
select * from tb where a not in (null);
a
drop table tb;
DROP DATABASE issue1332;
