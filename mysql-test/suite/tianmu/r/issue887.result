DROP DATABASE IF EXISTS issue887_test;
CREATE DATABASE issue887_test;
USE issue887_test;
DROP TABLE IF EXISTS t1,t2,t3;
CREATE TABLE t1 (a INT) ENGINE=TIANMU;
CREATE TABLE t2 (a INT) ENGINE=TIANMU;
CREATE TABLE t3 (a INT) ENGINE=TIANMU;
INSERT INTO t1 VALUES (1), (2), (3), (4);
INSERT INTO t2 VALUES (2), (3), (4);
INSERT INTO t3 VALUES (3), (4);
SELECT * FROM t1,t2,t3 ORDER BY t1.a,t2.a,t3.a;
a	a	a
1	2	3
1	2	4
1	3	3
1	3	4
1	4	3
1	4	4
2	2	3
2	2	4
2	3	3
2	3	4
2	4	3
2	4	4
3	2	3
3	2	4
3	3	3
3	3	4
3	4	3
3	4	4
4	2	3
4	2	4
4	3	3
4	3	4
4	4	3
4	4	4
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a
WHERE
t3.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	NULL	NULL
2	2	NULL
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a
WHERE
t3.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
3	3	3
4	4	4
SELECT
*
FROM
t1
RIGHT JOIN t2
RIGHT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a
WHERE
t3.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
SELECT
*
FROM
t1
RIGHT JOIN t2
RIGHT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a
WHERE
t3.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
3	3	3
4	4	4
SELECT
*
FROM
t1
INNER JOIN t2
INNER JOIN t3
WHERE
t3.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
SELECT
*
FROM
t1
INNER JOIN t2
INNER JOIN t3
WHERE
t3.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	2	3
1	2	4
1	3	3
1	3	4
1	4	3
1	4	4
2	2	3
2	2	4
2	3	3
2	3	4
2	4	3
2	4	4
3	2	3
3	2	4
3	3	3
3	3	4
3	4	3
3	4	4
4	2	3
4	2	4
4	3	3
4	3	4
4	4	3
4	4	4
SELECT
*
FROM
t1
CROSS JOIN t2
CROSS JOIN t3
WHERE
t3.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
SELECT
*
FROM
t1
CROSS JOIN t2
CROSS JOIN t3
WHERE
t3.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	2	3
1	2	4
1	3	3
1	3	4
1	4	3
1	4	4
2	2	3
2	2	4
2	3	3
2	3	4
2	4	3
2	4	4
3	2	3
3	2	4
3	3	3
3	3	4
3	4	3
3	4	4
4	2	3
4	2	4
4	3	3
4	3	4
4	4	3
4	4	4
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a AND
t3.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	NULL	NULL
2	2	NULL
3	NULL	NULL
4	NULL	NULL
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a AND
t3.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	NULL	NULL
2	NULL	NULL
3	3	3
4	4	4
SELECT
*
FROM
t1
RIGHT JOIN t2
RIGHT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a AND
t3.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
NULL	3	3
NULL	4	4
SELECT
*
FROM
t1
RIGHT JOIN t2
RIGHT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a AND
t3.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
3	3	3
4	4	4
SELECT
*
FROM
t1
INNER JOIN t2
INNER JOIN t3 ON
t3.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
SELECT
*
FROM
t1
INNER JOIN t2
INNER JOIN t3 ON
t3.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	2	3
1	2	4
1	3	3
1	3	4
1	4	3
1	4	4
2	2	3
2	2	4
2	3	3
2	3	4
2	4	3
2	4	4
3	2	3
3	2	4
3	3	3
3	3	4
3	4	3
3	4	4
4	2	3
4	2	4
4	3	3
4	3	4
4	4	3
4	4	4
SELECT
*
FROM
t1
CROSS JOIN t2
CROSS JOIN t3 ON
t3.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
SELECT
*
FROM
t1
CROSS JOIN t2
CROSS JOIN t3 ON
t3.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	2	3
1	2	4
1	3	3
1	3	4
1	4	3
1	4	4
2	2	3
2	2	4
2	3	3
2	3	4
2	4	3
2	4	4
3	2	3
3	2	4
3	3	3
3	3	4
3	4	3
3	4	4
4	2	3
4	2	4
4	3	3
4	3	4
4	4	3
4	4	4
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a
WHERE
t3.a > 3
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
4	4	4
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a AND
t3.a > 3
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	NULL	NULL
2	NULL	NULL
3	NULL	NULL
4	4	4
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a
WHERE
t3.a = 3
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
3	3	3
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a AND
t3.a = 3
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	NULL	NULL
2	NULL	NULL
3	3	3
4	NULL	NULL
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a
WHERE
t3.a < 3
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
SELECT
*
FROM
t1
LEFT JOIN t2
LEFT JOIN t3 ON
t2.a = t3.a ON
t1.a = t2.a AND
t3.a < 3
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	NULL	NULL
2	NULL	NULL
3	NULL	NULL
4	NULL	NULL
SELECT
*
FROM
t1,t2,t3
WHERE
t3.a IS NULL OR
t2.a IS NULL OR
t1.a IS NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
SELECT
*
FROM
t1,t2,t3
WHERE
t3.a IS NOT NULL OR
t2.a IS NOT NULL OR
t1.a IS NOT NULL
ORDER BY
t1.a,
t2.a,
t3.a;
a	a	a
1	2	3
1	2	4
1	3	3
1	3	4
1	4	3
1	4	4
2	2	3
2	2	4
2	3	3
2	3	4
2	4	3
2	4	4
3	2	3
3	2	4
3	3	3
3	3	4
3	4	3
3	4	4
4	2	3
4	2	4
4	3	3
4	3	4
4	4	3
4	4	4
DROP TABLE t1,t2,t3;
DROP DATABASE issue887_test;
